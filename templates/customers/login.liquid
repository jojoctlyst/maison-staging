{% capture required %}{{ 'customer.general.required_fields' | t }}{% endcapture %}
<div class="container-indent">
  <div class="container">
    <div class="tt-login-form">
      <div class="row justify-content-center">
        <div class="col-md-8 col-lg-6">
          <div class="tt-item">
            <div id="login">
              <h2 class="tt-title">{{ 'customer.login.title_login' | t }}</h2>

              <div class="form-default form-top">
                {% form 'customer_login' %}
                <div class="tt-base-color">
                {{ form.errors | default_errors }}
                </div>

                <div class="form-group">
                  <input type="email" name="customer[email]" class="form-control" id="loginInputName" placeholder=" ">
                  <label for="loginInputName">{{ 'customer.login.email' | t }}</label>
                </div>
                {% if form.password_needed %}
                <div class="form-group input-password-wrapper">
                    <input type="password" value="" name="customer[password]" class="form-control" id="loginInputPassword" placeholder=" ">
                  <label for="loginInputPassword">{{ 'customer.login.password' | t }}</label>
                  <div class="password-eye" id="password-eye-button">
                      <img src="{{ 'eye-close.svg' | asset_url }}" alt="" id="icon-eye">
                    </div>
                </div>
                {% endif %}

                  {% if form.password_needed %}
                    <div class="row justify-content-end">
                      <div class="col-auto align-self-end">
                        <div class="form-group">
                          <ul class="additional-links">
                            <li><a href="#" onclick="showRecoverPasswordForm();return false;">{{ 'customer.login.forgot_password' | t }}</a></li>
                          </ul>
                        </div>
                      </div>
                    </div>
                  {% endif %}

                <div class="row justify-content-center">
                  <div class="col">
                    <div class="form-group">
                      <button class="btn btn-primary-green btn-lg btn-block btn-submit" type="submit" id="login-button">{{ 'customer.login.sign_in' | t }}</button>
                    </div>
                  </div>
                </div>


                {% endform %}

                <div class="social-login-container">
                  <div class="wrapper">
                    <div class="row break-line mb-2">
                      <div class="line"></div>
                      <h2 class="title">atau login dengan</h2>
                      <div class="line"></div>
                    </div>
                    <div class='row oxi-social-login mb-2'></div>
                    <div class="row justify-content-center">
                      <div class="col-auto">
                        <div class="form-group register-label">
                          <div>{{ 'customer.login.new_customer_description' | t }}
                            <a href="/account/register" class="font-weight-bold"><u>{{ 'customer.login.new_customer_continue' | t }}</u>
                            </a>
                          </div>
                        </div>
                      </div>
                    </div>
                  </div>
                </div>
              </div>
            </div>

            <div id="recover-password" style="display:none;" class="wrap">
              <h2 class="tt-title">{{ 'customer.login.reset_password' | t }}</h2>
              {{ 'customer.login.reset_password_subtext' | t }}

              <div class="form-default form-top">
                {% form 'recover_customer_password' %}

                <div class="tt-base-color">
                {{ form.errors | default_errors }}
                </div>

                <div class="form-group">
                  <label for="loginInputName">{{ 'customer.login.email' | t }} {% if required != "" %}<sup>*</sup>{% endif %}</label>
                  {% if required != "" %}<div class="tt-required">{{ required }}</div>{% endif %}
                  <input value="" name="email" class="form-control" id="loginInputEmail" placeholder="{{ 'customer.login.email_field' | t }}" autocorrect="off" autocapitalize="off">
                </div>
                
                <div class="row">
                  <div class="col-auto">
                    <div class="form-group">
                      <button class="btn btn-border" type="submit">{{ 'customer.login.submit_recover' | t }}</button>
                    </div>
                  </div>
                  <div class="col-auto align-self-center">
                    <div class="form-group">
                      <ul class="additional-links">
                        <li>&nbsp;{{ 'customer.general.or' | t }} <a href="#" onclick="hideRecoverPasswordForm();return false;">{{ 'customer.login.cancel' | t }}</a></li>
                      </ul>
                    </div>
                  </div>
                </div>
                {% endform %}
              </div>
            </div>
            
          </div>
        </div>
      </div>
    </div>
  </div>
</div>

<script>
  window.dataLayer = window.dataLayer || [];
  dataLayer.push({ ecommerce: null });
  {% if first_time_accessed %}
  dataLayer.push({
    event: "purchase",
    ecommerce: {
      transaction_id: "{{ order.order_number }}",
      value: {{ total_price | times: 0.01 }},
      tax: {{ tax_price | times: 0.01 }},
      shipping: {{ shipping_price | times: 0.01 }},
      currency: "{{ order.currency }}",
      items: [
          {% for line_item in line_items %}{
          item_id: "{{ line_item.product_id }}",
          item_name: "{{ line_item.title | remove: "'" | remove: '"' }}",
          currency: "{{ order.currency }}",
          price: {{ line_item.final_price | times: 0.01 }},
          quantity: {{ line_item.quantity }}
        },{% endfor %}
      ]
    }
  });
  {% endif %}
</script>

<script type="text/javascript">
  function showRecoverPasswordForm() {
    document.getElementById('recover-password').style.display = 'block';
    document.getElementById('login').style.display='none';
  }

  function hideRecoverPasswordForm() {
    document.getElementById('recover-password').style.display = 'none';
    document.getElementById('login').style.display = 'block';
  }

  if (window.location.hash == '#recover') { showRecoverPasswordForm() }

  const eyeButton = document.getElementById("password-eye-button");
  eyeButton.onclick = function()  {
    const eyeOff = '{{ 'eye-close.svg' | asset_url }}';
    const eyeOn = '{{ 'eye-open.svg' | asset_url }}';
    const inputPassword = document.getElementById("loginInputPassword");
    const eyeImage = document.getElementById("icon-eye");
    if (inputPassword.type === "password") {
      inputPassword.type = "text";
      eyeImage.src = eyeOn;
    } else {
      inputPassword.type = "password";
      eyeImage.src = eyeOff;
    }
  }

  $(function () {
    $('#login-button').click( function () {
      dataLayer.push({ ecommerce: null });
      dataLayer.push({
        event: "login",
        ecommerce: {
          method: "email"
        }
      });
    console.dir(dataLayer);
    });

    // console.log($('.social_login'))

    $("#social_login_frame").load(function (){
      $("#social_login_frame").contents().find('.social_login').click(function () {
        alert(this);
      })
    })
  })
</script>